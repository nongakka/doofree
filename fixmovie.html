<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title></title>

<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<style>
:root{
--primary:#ff003c;
--bg-gradient:linear-gradient(135deg,#0f0f0f,#1a1a1a,#111);
--glass:rgba(255,255,255,0.06);
--border:rgba(255,255,255,0.1);
}

*{box-sizing:border-box;}
body{
margin:0;
font-family:'Kanit',sans-serif;
background:var(--bg-gradient);
color:#fff;
overflow:hidden;
}

/* PLAYER */
#player-container{
position:fixed;
top:0;left:0;
width:100%;height:100%;
background:#000;
transition:.3s ease;
z-index:1;
}
#player-container.blur{
filter:blur(8px) brightness(.6);
}

video{
width:100%;
height:100%;
object-fit:contain;
background:#000;
}

/* BUTTON */
#toggleBtn{
position:absolute;
top:20px;
left:20px;
background:linear-gradient(45deg,var(--primary),#ff5c5c);
border:none;
padding:10px 18px;
border-radius:30px;
color:#fff;
font-weight:600;
cursor:pointer;
z-index:5;
}

/* OVERLAY */
#overlay{
position:fixed;
top:0;left:0;
width:100%;height:100%;
background:rgba(0,0,0,.7);
opacity:0;
visibility:hidden;
transition:.3s;
z-index:8;
}
#overlay.active{
opacity:1;
visibility:visible;
}

/* MENU */
#menu{
position:fixed;
top:0;left:0;
width:350px;
height:100%;
background:rgba(20,20,20,.95);
backdrop-filter:blur(20px);
border-right:1px solid var(--border);
overflow-y:auto;
transform:translateX(-100%);
transition:.35s;
z-index:10;
padding-bottom:40px;
}
#menu.active{
transform:translateX(0);
}

/* SEARCH */
#search{
width:85%;
margin:15px auto 20px;
display:block;
padding:10px 15px;
border-radius:30px;
border:1px solid var(--border);
background:var(--glass);
color:#fff;
outline:none;
}

/* CHANNEL */
.channel{
display:flex;
align-items:center;
margin:10px 15px;
padding:12px;
background:var(--glass);
border:1px solid var(--border);
border-radius:15px;
cursor:pointer;
transition:.25s;
}
.channel:hover{
transform:translateY(-3px);
box-shadow:0 8px 25px rgba(0,0,0,.5);
border-color:var(--primary);
}
.channel img{
width:50px;
height:50px;
object-fit:contain;
border-radius:10px;
margin-right:12px;
background:#000;
padding:5px;
}

/* PREVIEW */
#preview{
position:fixed;
top:50%;
left:380px;
transform:translateY(-50%) scale(.9);
width:300px;
height:420px;
background:#111;
border-radius:20px;
box-shadow:0 0 40px rgba(0,0,0,.8);
overflow:hidden;
opacity:0;
transition:.3s;
z-index:15;
}
#preview.active{
opacity:1;
transform:translateY(-50%) scale(1);
}
#preview img{
width:100%;
height:100%;
object-fit:contain;
background:#000;
}

@media(max-width:768px){
#menu{width:90%;}
#preview{
left:50%;
transform:translate(-50%,-50%) scale(.9);
}
#preview.active{
transform:translate(-50%,-50%) scale(1);
}
}
</style>
</head>

<body>

<div id="player-container" class="blur">
<button id="toggleBtn">☰ เมนู</button>
<video id="video" controls></video>
</div>

<div id="overlay" class="active"></div>

<div id="menu" class="active">

<input type="text" id="search" placeholder="ค้นหาหนัง">
<div id="channel-list"></div>

</div>

<div id="preview"><img id="previewImg"></div>

<script>
const playlistURL="https://dl.dropboxusercontent.com/scl/fi/62fiv12wkovcvsja9ytjp/movie2535.m3u?rlkey=wc4lqa5rb334w7knv2c0jsmuh&st=i6a6uvtt&dl=0";
let channels=[], hls=null;

async function loadM3U(url){
const res=await fetch(url);
const text=await res.text();
const lines=text.split("\n");
let current={}, list=[];
for(let line of lines){
line=line.trim();
if(line.startsWith("#EXTINF")){
const name=line.match(/,(.*)$/);
const logo=line.match(/tvg-logo="(.*?)"/);
current={title:name?name[1]:"ไม่มีชื่อ",logo:logo?logo[1]:""};
}
else if(line && !line.startsWith("#")){
current.url=line;
list.push({...current});
}
}
return list;
}

function renderChannels(filter=""){
const container=document.getElementById("channel-list");
container.innerHTML="";
channels
.filter(c=>c.title.toLowerCase().includes(filter.toLowerCase()))
.forEach(ch=>{
const div=document.createElement("div");
div.className="channel";
div.innerHTML=`${ch.logo?`<img src="${ch.logo}">`:""}<span>${ch.title}</span>`;
div.onclick=()=>playChannel(ch);
div.onmouseenter=()=>showPreview(ch.logo);
div.onmouseleave=hidePreview;
container.appendChild(div);
});
}

function showPreview(img){
if(!img) return;
previewImg.src=img;
preview.classList.add("active");
}
function hidePreview(){
preview.classList.remove("active");
}

function playChannel(channel){
const video=document.getElementById("video");
if(hls){hls.destroy(); hls=null;}
if(video.canPlayType('application/vnd.apple.mpegurl')){
video.src=channel.url; video.play();
}else if(Hls.isSupported()){
hls=new Hls();
hls.loadSource(channel.url);
hls.attachMedia(video);
hls.on(Hls.Events.MANIFEST_PARSED,()=>video.play());
}
hidePreview();
toggleMenu(false);
}

function toggleMenu(force){
const menu=document.getElementById("menu");
const overlay=document.getElementById("overlay");
const player=document.getElementById("player-container");

if(force===false){
menu.classList.remove("active");
overlay.classList.remove("active");
player.classList.remove("blur");
return;
}
const isOpen=menu.classList.contains("active");
menu.classList.toggle("active",!isOpen);
overlay.classList.toggle("active",!isOpen);
player.classList.toggle("blur",!isOpen);
}

toggleBtn.onclick=()=>toggleMenu();
overlay.onclick=()=>toggleMenu(false);
search.oninput=e=>renderChannels(e.target.value);

async function init(){
channels=await loadM3U(playlistURL);
renderChannels();
}
init();
</script>

</body>
</html>