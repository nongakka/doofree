<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>หรรมน้อย ออนไลน์</title>

<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<style>
:root{
--accent:#7b2cff;
--accent-soft:rgba(123,44,255,0.25);
--accent-glow:0 0 18px rgba(123,44,255,0.7);
--bg:radial-gradient(circle at 20% 20%,#140a1f,#0a0614 60%,#000);
--glass:rgba(255,255,255,0.05);
--border:rgba(255,255,255,0.12);
}
*{box-sizing:border-box;}
body{
margin:0;
font-family:'Kanit',sans-serif;
background:var(--bg);
color:#fff;
overflow:hidden;
}

/* PLAYER */
#player-container{
position:fixed;
top:0;left:0;
width:100%;height:100%;
background:#000;
transition:.4s;
z-index:1;
}
#player-container.blur{
filter:blur(10px) brightness(.4);
}
video{
width:100%;
height:100%;
object-fit:contain;
background:#000;
}

/* OVERLAY */
#overlay{
position:fixed;
top:0;left:0;
width:100%;height:100%;
background:rgba(10,0,20,.75);
opacity:1;
visibility:visible;
transition:.3s;
z-index:8;
}
#overlay.hide{
opacity:0;
visibility:hidden;
}

/* MENU */
#menu{
position:fixed;
top:0;left:0;
width:340px;
height:100%;
background:rgba(20,10,35,.95);
backdrop-filter:blur(25px);
border-right:1px solid var(--accent-soft);
overflow-y:auto;
transform:translateX(0);
transition:.4s cubic-bezier(.4,0,.2,1);
z-index:10;
}
#menu.hide{
transform:translateX(-100%);
}

/* SEARCH */
#search{
width:85%;
margin:20px auto;
display:block;
padding:10px 18px;
border-radius:50px;
border:1px solid var(--accent-soft);
background:rgba(255,255,255,0.05);
color:#fff;
outline:none;
font-size:14px;
transition:.3s;
}
#search:focus{
border:1px solid var(--accent);
box-shadow:var(--accent-glow);
}

/* CATEGORY */
.category{
margin:12px;
border-radius:12px;
overflow:hidden;
border:1px solid var(--border);
background:rgba(255,255,255,0.03);
transition:.3s;
}
.category.active{
border-left:3px solid var(--accent);
box-shadow:var(--accent-glow);
}
.category-header{
padding:10px 14px;
cursor:pointer;
display:flex;
justify-content:space-between;
font-size:14px;
opacity:.9;
}
.category-content{display:none;}
.category.active .category-content{display:block;}

/* CHANNEL */
.channel{
display:flex;
align-items:center;
margin:6px 10px;
padding:8px;
background:rgba(255,255,255,0.05);
border-radius:8px;
cursor:pointer;
transition:.25s;
font-size:14px;
}
.channel:hover{
transform:translateX(6px);
background:var(--accent-soft);
box-shadow:var(--accent-glow);
}
.channel.active{
background:var(--accent-soft);
box-shadow:var(--accent-glow);
border:1px solid var(--accent);
}
.channel img{
width:36px;
height:36px;
object-fit:contain;
border-radius:6px;
margin-right:8px;
background:#000;
padding:3px;
}

/* PREVIEW */
#preview{
position:fixed;
top:50%;
left:370px;
transform:translateY(-50%) scale(.9);
width:280px;
height:400px;
background:#111;
border-radius:18px;
box-shadow:0 0 40px rgba(0,0,0,.8);
overflow:hidden;
opacity:0;
transition:.3s;
z-index:15;
}
#preview.active{
opacity:1;
transform:translateY(-50%) scale(1);
box-shadow:0 0 40px rgba(123,44,255,.7);
}
#preview img{
width:100%;
height:100%;
object-fit:contain;
background:#000;
}
</style>
</head>

<body>

<div id="player-container" class="blur">
<video id="video" controls autoplay></video>
</div>

<div id="overlay"></div>

<div id="menu">
<input type="text" id="search" placeholder="ค้นหาหนัง">
<div id="channel-list"></div>
</div>

<div id="preview">
<img id="previewImg">
</div>

<script>
const playlistURL="https://raw.githubusercontent.com/9Pichapob/Movies/refs/heads/main/NETFLIX";
let channels=[],grouped={},hls=null;
let closeTimer=null;
let currentChannelElement=null;

const menu=document.getElementById("menu");
const overlay=document.getElementById("overlay");
const player=document.getElementById("player-container");
const preview=document.getElementById("preview");
const previewImg=document.getElementById("previewImg");

/* MENU CONTROL */
function openMenu(){
clearTimeout(closeTimer);
menu.classList.remove("hide");
overlay.classList.remove("hide");
player.classList.add("blur");
}
function closeMenuSmooth(){
clearTimeout(closeTimer);
closeTimer=setTimeout(()=>{
menu.classList.add("hide");
overlay.classList.add("hide");
player.classList.remove("blur");
},400);
}
document.addEventListener("mousemove",(e)=>{
if(e.clientX<=15){ openMenu(); }
});
menu.addEventListener("mouseleave",closeMenuSmooth);
menu.addEventListener("mouseenter",()=>clearTimeout(closeTimer));
overlay.addEventListener("click",()=>{
menu.classList.add("hide");
overlay.classList.add("hide");
player.classList.remove("blur");
});

/* PREVIEW */
function showPreview(img){
if(!img) return;
previewImg.src=img;
preview.classList.add("active");
}
function hidePreview(){
preview.classList.remove("active");
}

/* PLAYLIST */
function isValidVideoURL(url){
const clean=url.split("?")[0].toLowerCase();
return clean.endsWith(".m3u8")||clean.endsWith(".mp4");
}

async function loadM3U(url){
const res=await fetch(url);
const text=await res.text();
const lines=text.split("\n");
let current={},list=[];
for(let line of lines){
line=line.trim();
if(line.startsWith("#EXTINF")){
const name=line.match(/,(.*)$/);
const logo=line.match(/tvg-logo="(.*?)"/);
const group=line.match(/group-title="(.*?)"/);
current={
title:(name&&name[1])?name[1].trim():"ไม่มีชื่อ",
logo:(logo&&logo[1])?logo[1].trim():"",
group:(group&&group[1])?group[1].trim():"อื่นๆ"
};
}else if(line && !line.startsWith("#")){
if(isValidVideoURL(line)){
current.url=line.trim();
list.push({...current});
}
}
}
return list;
}

function groupChannels(){
grouped={};
channels.forEach(c=>{
if(!grouped[c.group]) grouped[c.group]=[];
grouped[c.group].push(c);
});
}

function renderGroups(){
const container=document.getElementById("channel-list");
container.innerHTML="";
for(let group in grouped){
const cat=document.createElement("div");
cat.className="category";

const header=document.createElement("div");
header.className="category-header";
header.innerHTML=`<span>${group}</span><span>+</span>`;
header.onclick=()=>cat.classList.toggle("active");

const content=document.createElement("div");
content.className="category-content";

grouped[group].forEach(ch=>{
const div=document.createElement("div");
div.className="channel";

div.innerHTML=`
${ch.logo?`<img src="${ch.logo}" onerror="this.style.display='none'">`:""}
<span>${ch.title}</span>
`;

div.onclick=()=>{
playChannel(ch);
if(currentChannelElement) currentChannelElement.classList.remove("active");
div.classList.add("active");
currentChannelElement=div;
};

div.onmouseenter=()=>showPreview(ch.logo);
div.onmouseleave=hidePreview;

content.appendChild(div);
});

cat.appendChild(header);
cat.appendChild(content);
container.appendChild(cat);
}
}

function playChannel(channel){
const video=document.getElementById("video");
if(hls){hls.destroy();hls=null;}
video.pause();
video.removeAttribute("src");
video.load();

const clean=channel.url.split("?")[0].toLowerCase();

if(clean.endsWith(".m3u8")){
if(video.canPlayType('application/vnd.apple.mpegurl')){
video.src=channel.url;
video.play();
}else if(Hls.isSupported()){
hls=new Hls();
hls.loadSource(channel.url);
hls.attachMedia(video);
hls.on(Hls.Events.MANIFEST_PARSED,()=>video.play());
}
}else{
video.src=channel.url;
video.play();
}
closeMenuSmooth();
}

document.getElementById("search").addEventListener("input",e=>{
const keyword=e.target.value.toLowerCase();
document.querySelectorAll(".channel").forEach(ch=>{
ch.style.display=ch.innerText.toLowerCase().includes(keyword)?"flex":"none";
});
});

async function init(){
channels=await loadM3U(playlistURL);
groupChannels();
renderGroups();
}
init();
</script>

</body>
</html>
