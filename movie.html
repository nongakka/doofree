<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>à¸«à¸£à¸£à¸¡à¸™à¹‰à¸­à¸¢ à¸­à¸­à¸™à¹„à¸¥à¸™à¹Œ</title>

<script src="https://ssl.p.jwpcdn.com/player/v/8.26.0/jwplayer.js"></script>
<script>
jwplayer.key = "XSuP4qMl+9tK17QNb+4+th2Pm9AWgMO/cYH8CI0HGGr7bdjo";
</script>

<style>
html{scroll-behavior:smooth;}
body{margin:0;background:#000;color:#fff;font-family:sans-serif;text-align:center}
#player{width:90%;max-width:1200px;aspect-ratio:16/9;margin:15px auto}

#categories{
display:flex;flex-wrap:wrap;gap:8px;
justify-content:center;padding:10px;
}

.category{
padding:6px 14px;background:#222;border:1px solid #444;
border-radius:20px;cursor:pointer;font-size:13px;
}
.category.active{background:orange;color:black;}

#channels{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(130px,1fr));
gap:20px;padding:25px;
max-width:1200px;margin:auto;
}

.channel{
background:#111;border:1px solid #333;
border-radius:14px;padding:12px;
cursor:pointer;display:flex;
flex-direction:column;align-items:center;
justify-content:center;height:150px;
transition:.2s;position:relative;
}

.channel:hover{border-color:orange;transform:scale(1.05);}
.channel.active{background:orange;color:black;}

.channel img{
width:75px;height:75px;
object-fit:cover;border-radius:8px;
margin-bottom:6px;
}

.channel .name{
font-size:13px;
white-space:nowrap;
overflow:hidden;
text-overflow:ellipsis;
width:100%;text-align:center;
}

/* Tooltip à¸šà¸™ */
.channel::after{
content: attr(data-fullname);
position:absolute;bottom:100%;left:50%;
transform:translateX(-50%) translateY(-10px);
background:#000;padding:6px 12px;
font-size:12px;border-radius:6px;
white-space:nowrap;opacity:0;
transition:.2s;pointer-events:none;
}
.channel:hover::after{opacity:1;}
</style>
</head>

<body>

<h2 style="color:orange;">à¸«à¸£à¸£à¸¡à¸™à¹‰à¸­à¸¢ à¸­à¸­à¸™à¹„à¸¥à¸™à¹Œ</h2>

<div id="player"></div>
<div id="categories"></div>
<div id="channels"></div>

<script>

const DEFAULT_LOGO = "https://cdn-icons-png.flaticon.com/512/149/149071.png";
const m3uUrl = "https://dl.dropboxusercontent.com/scl/fi/62fiv12wkovcvsja9ytjp/movie2535.m3u?rlkey=wc4lqa5rb334w7knv2c0jsmuh&st=i6a6uvtt&dl=0";

let player = jwplayer("player");
let allChannels = [];

fetch(m3uUrl)
.then(res => res.text())
.then(text => parseM3U(text));

function parseM3U(text){

    const lines = text.split("\n");
    let current = {};

    lines.forEach(line => {

        line = line.trim();

        if(line.startsWith("#EXTINF")){
            current = {};

            // ðŸ”¥ à¸”à¸¶à¸‡ tvg-name à¹à¸šà¸šà¸›à¸¥à¸­à¸”à¸ à¸±à¸¢
            const nameMatch = line.match(/tvg-name="(.*?)"/);
            current.name = nameMatch 
                ? nameMatch[1] 
                : line.substring(line.lastIndexOf(",")+1);

            const logoMatch = line.match(/tvg-logo="(.*?)"/);
            current.logo = logoMatch ? logoMatch[1] : DEFAULT_LOGO;

            const groupMatch = line.match(/group-title="(.*?)"/);
            current.group = groupMatch ? groupMatch[1] : "à¸­à¸·à¹ˆà¸™à¹†";
        }

        else if(line.startsWith("http")){
            current.file = line;
            current.type = "hls"; // ðŸ”¥ à¸šà¸±à¸‡à¸„à¸±à¸šà¹€à¸›à¹‡à¸™ HLS à¸ªà¸³à¸«à¸£à¸±à¸š m3u8
            allChannels.push({...current});
        }

    });

    renderCategories();
}

function renderCategories(){

    const container = document.getElementById("categories");
    container.innerHTML = "";

    const groups = [...new Set(allChannels.map(ch => ch.group))];
    groups.unshift("à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”");

    groups.forEach((group)=>{

        const btn = document.createElement("div");
        btn.className = "category";
        btn.innerText = group;

        btn.onclick = ()=>{
            document.querySelectorAll(".category")
                .forEach(el=>el.classList.remove("active"));
            btn.classList.add("active");

            if(group==="à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”"){
                renderChannels(allChannels);
            }else{
                renderChannels(allChannels.filter(ch=>ch.group===group));
            }
        };

        container.appendChild(btn);

        if(group==="à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”"){
            btn.classList.add("active");
            renderChannels(allChannels);
        }
    });
}

function renderChannels(list){

    const container = document.getElementById("channels");
    container.innerHTML = "";

    list.forEach((ch)=>{

        const div = document.createElement("div");
        div.className="channel";
        div.setAttribute("data-fullname", ch.name);

        div.innerHTML = `
            <img src="${ch.logo}" 
                 onerror="this.src='${DEFAULT_LOGO}'">
            <div class="name">${ch.name}</div>
        `;

        div.onclick = ()=>{
            playChannel(ch,div);
            document.getElementById("player")
                .scrollIntoView({behavior:"smooth"});
        };

        container.appendChild(div);
    });
}

function playChannel(channel,element){

    document.querySelectorAll(".channel")
        .forEach(el=>el.classList.remove("active"));
    element.classList.add("active");

    player.stop(true);

    player.setup({
        file: channel.file,
        type: "hls",
        width:"100%",
        aspectratio:"16:9"
    });
}

</script>

</body>
</html>
