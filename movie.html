<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Movie JSON Player</title>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<style>
body{
    margin:0;
    display:flex;
    height:100vh;
    background:#000;
    color:#fff;
    font-family:sans-serif;
}
#menu{
    width:35%;
    background:#111;
    overflow-y:auto;
    padding:10px;
}
#player{
    flex:1;
}
video{
    width:100%;
    height:100%;
}

/* ðŸ”¥ Card Style */
.channel{
    display:flex;
    gap:10px;
    padding:8px;
    border-bottom:1px solid #333;
    cursor:pointer;
    align-items:center;
    transition:0.2s;
}
.channel:hover{
    background:#222;
}

.thumb{
    width:80px;
    height:110px;
    object-fit:cover;
    border-radius:6px;
    background:#333;
}

.info{
    flex:1;
}

.title{
    font-size:14px;
    font-weight:bold;
    margin-bottom:5px;
}

.sub{
    font-size:12px;
    color:#aaa;
}

h3{
    margin-top:0;
}
</style>
</head>

<body>

<div id="menu">
    <h3 id="playlistTitle">Loading...</h3>
    <div id="channels"></div>
</div>

<div id="player">
    <video id="video" controls autoplay></video>
</div>

<script>

const video = document.getElementById("video");
let hls;

// ðŸ‘‰ à¹ƒà¸ªà¹ˆà¸¥à¸´à¸‡à¸à¹Œ JSON à¸•à¸£à¸‡à¸™à¸µà¹‰
const originalUrl = "https://nikky.redfight.info/wiseplay/iptv/movies/123/123hdtv_à¸«à¸™à¸±à¸‡à¹ƒà¸«à¸¡à¹ˆ-2026.w3u";

// à¹ƒà¸Šà¹‰ proxy à¸à¸±à¸™ CORS
const url = "https://api.allorigins.win/raw?url=" + encodeURIComponent(originalUrl);

fetch(url)
.then(res=>res.text())
.then(text=>{

    let data;

    try{
        data = JSON.parse(text);
    }catch(e){
        alert("à¹„à¸Ÿà¸¥à¹Œà¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ JSON");
        return;
    }

    document.getElementById("playlistTitle").innerText = data.name || "Playlist";

    renderChannels(data.stations);

})
.catch(err=>{
    alert("à¹‚à¸«à¸¥à¸”à¹„à¸¡à¹ˆà¹„à¸”à¹‰");
    console.log(err);
});

function renderChannels(stations){

    const container = document.getElementById("channels");
    container.innerHTML = "";

    stations.forEach((item,index)=>{

        const div = document.createElement("div");
        div.className = "channel";

        div.innerHTML = `
            <img src="${item.image}" class="thumb" onerror="this.src=''">
            <div class="info">
                <div class="title">${item.name}</div>
                <div class="sub">${item.info || ""}</div>
            </div>
        `;

        div.onclick = ()=>{
            playChannel(item.url, item.referer);
        };

        container.appendChild(div);

        // ðŸ”¥ à¹€à¸¥à¹ˆà¸™à¸•à¸±à¸§à¹à¸£à¸à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´
        if(index===0){
            playChannel(item.url, item.referer);
        }

    });

}

function playChannel(url, referer){

    if(hls){
        hls.destroy();
    }

    if(Hls.isSupported()){
        hls = new Hls({
            xhrSetup: function(xhr){
                if(referer){
                    xhr.setRequestHeader("Referer", referer);
                }
            }
        });

        hls.loadSource(url);
        hls.attachMedia(video);
    }else{
        video.src = url;
    }

    video.play().catch(()=>{});

}

</script>

</body>
</html>