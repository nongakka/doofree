<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>หรรมน้อย ออนไลน์</title>

<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<style>
:root{
--primary:linear-gradient(135deg,#ff3cac,#784ba0,#2b86c5);
--bg:radial-gradient(circle at 20% 20%,#1a1a2e,#0f0f1a 50%,#000);
--glass:rgba(255,255,255,0.07);
--border:rgba(255,255,255,0.15);
}

*{box-sizing:border-box;}
body{
margin:0;
font-family:'Kanit',sans-serif;
background:var(--bg);
color:#fff;
overflow:hidden;
}

/* PLAYER */
#player-container{
position:fixed;
top:0;left:0;
width:100%;height:100%;
background:#000;
transition:.4s;
z-index:1;
}
#player-container.blur{
filter:blur(10px) brightness(.5);
}
video{
width:100%;
height:100%;
object-fit:contain;
background:#000;
}

/* BUTTON */
#toggleBtn{
position:absolute;
top:20px;
left:20px;
background:var(--primary);
border:none;
padding:10px 22px;
border-radius:50px;
color:#fff;
font-weight:500;
cursor:pointer;
z-index:5;
box-shadow:0 0 20px rgba(255,0,200,.5);
transition:.3s;
}
#toggleBtn:hover{
transform:scale(1.05);
box-shadow:0 0 30px rgba(0,200,255,.8);
}

/* OVERLAY */
#overlay{
position:fixed;
top:0;left:0;
width:100%;height:100%;
background:rgba(0,0,0,.75);
opacity:0;
visibility:hidden;
transition:.3s;
z-index:8;
}
#overlay.active{
opacity:1;
visibility:visible;
}

/* MENU */
#menu{
position:fixed;
top:0;left:0;
width:360px;
height:100%;
background:rgba(25,25,35,.95);
backdrop-filter:blur(25px);
border-right:1px solid var(--border);
overflow-y:auto;
transform:translateX(-100%);
transition:.4s;
z-index:10;
box-shadow:5px 0 40px rgba(0,0,0,.8);
}
#menu.active{
transform:translateX(0);
}

.menu-header{
text-align:center;
padding:20px 15px;
border-bottom:1px solid var(--border);
}
.menu-header img{
width:160px;
filter:drop-shadow(0 0 12px rgba(255,255,255,.3));
}
.menu-header h3{
margin:10px 0 0;
font-weight:600;
font-size:20px;
background:var(--primary);
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
}

/* SEARCH */
#search{
width:85%;
margin:20px auto;
display:block;
padding:10px 18px;
border-radius:50px;
border:1px solid var(--border);
background:var(--glass);
color:#fff;
outline:none;
font-weight:400;
transition:.3s;
}
#search:focus{
box-shadow:0 0 15px rgba(0,200,255,.5);
border-color:#2b86c5;
}

/* CATEGORY */
.category{
margin:12px;
border-radius:16px;
overflow:hidden;
border:1px solid var(--border);
background:rgba(255,255,255,0.05);
transition:.3s;
}
.category-header{
padding:10px 18px;
cursor:pointer;
font-weight:500;
display:flex;
justify-content:space-between;
align-items:center;
background:linear-gradient(90deg,rgba(255,255,255,0.08),transparent);
transition:.3s;
}
.category-header:hover{
background:linear-gradient(90deg,rgba(255,0,200,.2),rgba(0,200,255,.2));
}
.category-content{
display:none;
padding:6px 0;
}
.category.active .category-content{
display:block;
}

/* CHANNEL */
.channel{
display:flex;
align-items:center;
margin:6px 12px;
padding:8px;
background:rgba(255,255,255,0.05);
border-radius:12px;
cursor:pointer;
transition:.25s;
font-weight:400;
font-size:14px;
}
.channel:hover{
transform:translateX(6px);
background:linear-gradient(90deg,rgba(255,0,200,.2),rgba(0,200,255,.2));
box-shadow:0 0 15px rgba(0,200,255,.5);
}
.channel img{
width:38px;
height:38px;
object-fit:contain;
border-radius:8px;
margin-right:10px;
background:#000;
padding:3px;
}

/* PREVIEW */
#preview{
position:fixed;
top:50%;
left:390px;
transform:translateY(-50%) scale(.9);
width:300px;
height:420px;
background:#111;
border-radius:25px;
box-shadow:0 0 50px rgba(0,0,0,.9);
overflow:hidden;
opacity:0;
transition:.4s;
z-index:15;
}
#preview.active{
opacity:1;
transform:translateY(-50%) scale(1);
}
#preview img{
width:100%;
height:100%;
object-fit:contain;
background:#000;
}

@media(max-width:768px){
#menu{width:90%;}
#preview{
left:50%;
transform:translate(-50%,-50%) scale(.9);
}
#preview.active{
transform:translate(-50%,-50%) scale(1);
}
}
</style>
</head>

<body>

<div id="player-container" class="blur">
<button id="toggleBtn">☰ เมนู</button>
<video id="video" controls></video>
</div>

<div id="overlay" class="active"></div>

<div id="menu" class="active">
<div class="menu-header">
<img src="https://img2.pic.in.th/ChatGPT-Image-23-..-2569-10_56_05.png">
<h3>หรรมน้อย ออนไลน์</h3>
</div>

<input type="text" id="search" placeholder="ค้นหาหนัง">
<div id="channel-list"></div>
</div>

<div id="preview"><img id="previewImg"></div>

<script>
const playlistURL="https://raw.githubusercontent.com/9Pichapob/Movies/refs/heads/main/NETFLIX";
const MAX_PER_GROUP=200;

let channels=[],grouped={},hls=null;

async function loadM3U(url){
const res=await fetch(url);
const text=await res.text();
const lines=text.split("\n");
let current={},list=[];
for(let line of lines){
line=line.trim();
if(line.startsWith("#EXTINF")){
const name=line.match(/,(.*)$/);
const logo=line.match(/tvg-logo="(.*?)"/);
const group=line.match(/group-title="(.*?)"/);
current={
title:(name&&name[1])?name[1].trim():"ไม่มีชื่อ",
logo:(logo&&logo[1])?logo[1].trim():"",
group:(group&&group[1])?group[1].trim():"อื่นๆ"
};
}
else if(line && !line.startsWith("#")){
current.url=line.trim();
if(current.title && current.url){list.push({...current});}
}
}
return list;
}

function groupChannels(){
grouped={};
channels.forEach(c=>{
if(!grouped[c.group]) grouped[c.group]=[];
if(grouped[c.group].length<MAX_PER_GROUP){
grouped[c.group].push(c);
}
});
}

function renderGroups(){
const container=document.getElementById("channel-list");
container.innerHTML="";
for(let group in grouped){
if(!group) continue;
const cat=document.createElement("div");
cat.className="category";

const header=document.createElement("div");
header.className="category-header";
header.innerHTML=`<span>${group}</span><span>+</span>`;

const content=document.createElement("div");
content.className="category-content";

let loaded=false;
header.onclick=()=>{
cat.classList.toggle("active");
header.querySelector("span:last-child").textContent=
cat.classList.contains("active")?"−":"+";

if(!loaded){
grouped[group].forEach(ch=>{
const div=document.createElement("div");
div.className="channel";
div.innerHTML=`${ch.logo?`<img loading="lazy" src="${ch.logo}" onerror="this.style.display='none'">`:""}<span>${ch.title}</span>`;
div.onclick=()=>playChannel(ch);
div.onmouseenter=()=>showPreview(ch.logo);
div.onmouseleave=hidePreview;
content.appendChild(div);
});
loaded=true;
}
};

cat.appendChild(header);
cat.appendChild(content);
container.appendChild(cat);
}
}

function showPreview(img){
if(!img) return;
previewImg.src=img;
preview.classList.add("active");
}
function hidePreview(){preview.classList.remove("active");}

function playChannel(channel){
const video=document.getElementById("video");
if(hls){hls.destroy();hls=null;}
if(video.canPlayType('application/vnd.apple.mpegurl')){
video.src=channel.url;video.play();
}else if(Hls.isSupported()){
hls=new Hls();
hls.loadSource(channel.url);
hls.attachMedia(video);
hls.on(Hls.Events.MANIFEST_PARSED,()=>video.play());
}
hidePreview();
toggleMenu(false);
}

function toggleMenu(force){
const menu=document.getElementById("menu");
const overlay=document.getElementById("overlay");
const player=document.getElementById("player-container");

if(force===false){
menu.classList.remove("active");
overlay.classList.remove("active");
player.classList.remove("blur");
return;
}
const isOpen=menu.classList.contains("active");
menu.classList.toggle("active",!isOpen);
overlay.classList.toggle("active",!isOpen);
player.classList.toggle("blur",!isOpen);
}

toggleBtn.onclick=()=>toggleMenu();
overlay.onclick=()=>toggleMenu(false);

document.getElementById("search").addEventListener("input",e=>{
const keyword=e.target.value.toLowerCase();
document.querySelectorAll(".channel").forEach(ch=>{
ch.style.display=ch.innerText.toLowerCase().includes(keyword)?"flex":"none";
});
});

async function init(){
channels=await loadM3U(playlistURL);
groupChannels();
renderGroups();
}
init();
</script>

</body>
</html>
